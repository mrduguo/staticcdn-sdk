defaultTasks 'clean', 'build'
buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath 'io.staticcdn.sdk:staticcdn-sdk-gradle-plugin:${project.version}'
    }
}
apply plugin: 'groovy'
apply plugin: 'staticcdn'

staticcdn {
    inputWwwRoots = ['wwwroot/']
    outputWwwRoot = 'build/optimized-files/'
    inputFilePathPatterns = [
            '^.*html$',
    ]
    optimiserOptions = [
            autoEmbedCss          : true,
            autoDataUrlMaxFileSize: 1000
    ]
}

task prepareWwwroot(type: Copy, dependsOn: 'staticcdnOptimise') {
    from 'wwwroot/'
    from 'build/optimized-files/'
    exclude '**/original-*'
    into { 'build/optimized-wwwroot/' }
}
tasks.build.dependsOn prepareWwwroot

